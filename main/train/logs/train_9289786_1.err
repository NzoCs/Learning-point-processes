GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
INFO:datasets:PyTorch version 2.6.0 available.
Traceback (most recent call last):
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/util/connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/gpfs/softs/spack_0.17/opt/spack/linux-centos7-cascadelake/gcc-11.2.0/python-3.9.10-vbc5su2pswnex4cavi6abfzkbtrpecsj/lib/python3.9/socket.py", line 954, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connectionpool.py", line 488, in _make_request
    raise new_e
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x2b4a8e012a00>: Failed to resolve 'cdn-lfs-us-1.hf.co' ([Errno -2] Name or service not known)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='cdn-lfs-us-1.hf.co', port=443): Max retries exceeded with url: /repos/0f/5c/0f5ccadf8b30d60ec7a43572bed8a95c84f16d7d01802e08672e802a7abd54df/d7346a5a7d66175498d701d26b093c69aae9be731b0720dd9898ea5acd13f795?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27train-00000-of-00001.parquet%3B+filename%3D%22train-00000-of-00001.parquet%22%3B&Expires=1745025572&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc0NTAyNTU3Mn19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zLzBmLzVjLzBmNWNjYWRmOGIzMGQ2MGVjN2E0MzU3MmJlZDhhOTVjODRmMTZkN2QwMTgwMmUwODY3MmU4MDJhN2FiZDU0ZGYvZDczNDZhNWE3ZDY2MTc1NDk4ZDcwMWQyNmIwOTNjNjlhYWU5YmU3MzFiMDcyMGRkOTg5OGVhNWFjZDEzZjc5NT9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=kVtPe4LQuj9ZCEMZ3j2SLvOmQk2kmr1gHJC7CA5H-qxdX7G1ayGnqBieM2wBzmGR8oGIE0-MB6I0f5YeASDz~-b-gUDLeUyxd4FElGPLpaNfvEc5x1DfcD~pKYI7xI0xQ~nETHxqE6Wd3F0LncjVJ7ltsYRsB2QeFe9pGQ0b7Nxx9Wjv9gbAyDQ~TXedwEy5hfAQN1jegZxD6WVNI7GsWJHQ75cDTk2eBtlHMbmZGiO97Q2bE8AsDLoYxcVM8l34F4jbLUloup2jCO48izXtDuuISspO94I9HyrwYem04jG4EqKGUDaQpPO5x4rRU4LnRwlaSxrkSfOVk7f9vfSM-g__&Key-Pair-Id=K24J24Z295AEI9 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x2b4a8e012a00>: Failed to resolve 'cdn-lfs-us-1.hf.co' ([Errno -2] Name or service not known)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/users/regnaguen/Learning-point-processes/main/train/train.py", line 31, in <module>
    main()
  File "/gpfs/users/regnaguen/Learning-point-processes/main/train/train.py", line 27, in main
    plrunner.train()
  File "/gpfs/users/regnaguen/Learning-point-processes/easy_tpp/runner/trainer.py", line 154, in train
    self.datamodule.setup(stage='fit')
  File "/gpfs/users/regnaguen/Learning-point-processes/easy_tpp/preprocess/data_loader.py", line 129, in setup
    self.train_data = self.build_input(train_data_dir, self.data_config.data_format, 'train')
  File "/gpfs/users/regnaguen/Learning-point-processes/easy_tpp/preprocess/data_loader.py", line 59, in build_input
    return self._build_input_from_json(source_dir, split)
  File "/gpfs/users/regnaguen/Learning-point-processes/easy_tpp/preprocess/data_loader.py", line 101, in _build_input_from_json
    data = load_dataset(source_dir, split=split_mapped)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/load.py", line 2084, in load_dataset
    builder_instance.download_and_prepare(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/builder.py", line 925, in download_and_prepare
    self._download_and_prepare(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/builder.py", line 979, in _download_and_prepare
    split_generators = self._split_generators(dl_manager, **split_generators_kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/packaged_modules/parquet/parquet.py", line 49, in _split_generators
    data_files = dl_manager.download_and_extract(self.config.data_files)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/download/download_manager.py", line 326, in download_and_extract
    return self.extract(self.download(url_or_urls))
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/download/download_manager.py", line 159, in download
    downloaded_path_or_paths = map_nested(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 513, in map_nested
    mapped = [
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 514, in <listcomp>
    _single_map_nested((function, obj, batched, batch_size, types, None, True, None))
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 401, in _single_map_nested
    mapped = [_single_map_nested((function, v, batched, batch_size, types, None, True, None)) for v in pbar]
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 401, in <listcomp>
    mapped = [_single_map_nested((function, v, batched, batch_size, types, None, True, None)) for v in pbar]
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 382, in _single_map_nested
    return [mapped_item for batch in iter_batched(data_struct, batch_size) for mapped_item in function(batch)]
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/py_utils.py", line 382, in <listcomp>
    return [mapped_item for batch in iter_batched(data_struct, batch_size) for mapped_item in function(batch)]
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/download/download_manager.py", line 219, in _download_batched
    return [
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/download/download_manager.py", line 220, in <listcomp>
    self._download_single(url_or_filename, download_config=download_config)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/download/download_manager.py", line 229, in _download_single
    out = cached_path(url_or_filename, download_config=download_config)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/datasets/utils/file_utils.py", line 183, in cached_path
    output_path = huggingface_hub.HfApi(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/hf_api.py", line 5475, in hf_hub_download
    return hf_hub_download(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 961, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1112, in _hf_hub_download_to_cache_dir
    _download_to_tmp_and_move(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 1675, in _download_to_tmp_and_move
    http_get(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 376, in http_get
    r = _request_wrapper(
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/file_download.py", line 308, in _request_wrapper
    response = get_session().request(method=method, url=url, **params)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/huggingface_hub/utils/_http.py", line 96, in send
    return super().send(request, *args, **kwargs)
  File "/gpfs/workdir/regnaguen/LTPP/lib/python3.9/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: (MaxRetryError('HTTPSConnectionPool(host=\'cdn-lfs-us-1.hf.co\', port=443): Max retries exceeded with url: /repos/0f/5c/0f5ccadf8b30d60ec7a43572bed8a95c84f16d7d01802e08672e802a7abd54df/d7346a5a7d66175498d701d26b093c69aae9be731b0720dd9898ea5acd13f795?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27train-00000-of-00001.parquet%3B+filename%3D%22train-00000-of-00001.parquet%22%3B&Expires=1745025572&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc0NTAyNTU3Mn19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zLzBmLzVjLzBmNWNjYWRmOGIzMGQ2MGVjN2E0MzU3MmJlZDhhOTVjODRmMTZkN2QwMTgwMmUwODY3MmU4MDJhN2FiZDU0ZGYvZDczNDZhNWE3ZDY2MTc1NDk4ZDcwMWQyNmIwOTNjNjlhYWU5YmU3MzFiMDcyMGRkOTg5OGVhNWFjZDEzZjc5NT9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=kVtPe4LQuj9ZCEMZ3j2SLvOmQk2kmr1gHJC7CA5H-qxdX7G1ayGnqBieM2wBzmGR8oGIE0-MB6I0f5YeASDz~-b-gUDLeUyxd4FElGPLpaNfvEc5x1DfcD~pKYI7xI0xQ~nETHxqE6Wd3F0LncjVJ7ltsYRsB2QeFe9pGQ0b7Nxx9Wjv9gbAyDQ~TXedwEy5hfAQN1jegZxD6WVNI7GsWJHQ75cDTk2eBtlHMbmZGiO97Q2bE8AsDLoYxcVM8l34F4jbLUloup2jCO48izXtDuuISspO94I9HyrwYem04jG4EqKGUDaQpPO5x4rRU4LnRwlaSxrkSfOVk7f9vfSM-g__&Key-Pair-Id=K24J24Z295AEI9 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x2b4a8e012a00>: Failed to resolve \'cdn-lfs-us-1.hf.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: cb7c932f-eb8a-489a-b0f0-5affc5a0f86c)')
srun: error: ruche-gpu13: task 0: Exited with exit code 1
